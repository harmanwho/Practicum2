---
title: "CS5200 Practicum II: Harmandeep Sidhu & Robert Zipp"
output: html_notebook
---

# Introduction

This practicum assignment creates a relational database using MySQL for the publicly available IMDB dataset. 

## ERD Diagrams

### Initial diagram
The following is an ERD diagram of the IMDB database after reading data description and normalization. 

![Figure 1: ERD diagram 1 for relational database](ERD.png)
### Futher normalized diagram
The following is an ERD diagram of the IMDB database includes added attributes, junction and look-up tables. 

![Figure 2: ERD diagram 2 for relational database](Updated ERD.jpeg)


We can guarantee this model represents the data in at least BCNF because it fulfills the requirements for all normal forms up to and including BCNF.
Exception: As mentioned in the Rubric - ```title.akas``` & ```title.principals``` are attempted to normalize but might be an exception due to the complexity.

First Normal Form: Each column contains atomic values.  
Second Normal Form: The table is in first normal form and all the columns depend on the table's primary key.  
Third Normal Form: The table is in second normal form and all of its columns are not transitively dependent on the primary key.  
BCNF: The table is in third normal form and for any dependency A -> B, A is a super key.

### R Setup

```{r dbconn}

library(DBI)
library(RMariaDB)

db <- DBI::dbConnect(
  drv = RMariaDB::MariaDB(),
  dbname = "yourDBName",
  host = "localhost",
  username = "yourUser::root",
  password = "yourPassword"
)

knitr::opts_chunk$set(connection = "db")

```

```{sql, connection="db"}
CREATE TABLE titleBasics (
    tconst VARCHAR(256) PRIMARY KEY,
    titleType VARCHAR(256),
    primaryTitle VARCHAR(256),
    originalTitle VARCHAR(256),
    isAdult BOOLEAN,
    runtimeMinutes INT
);

```

```{sql, connection="db"}

CREATE TABLE titleGenres (
	tconst VARCHAR(256),
    genre VARCHAR(256),
    CONSTRAINT tconst_fk FOREIGN KEY (tconst) REFERENCES titleBasics (tconst)
);
```

```{sql, connection="db"}
CREATE TABLE titleRatings (
	tconst VARCHAR(256),
    averageRating FLOAT,
    numVotes INT,
    CONSTRAINT rating_fk FOREIGN KEY (tconst) REFERENCES titleBasics (tconst)
);
```

```{sql, connection="db"}
CREATE TABLE titleDates (
	tconst VARCHAR(256),
    startyear INT,
    endyear INT,
    CONSTRAINT titleDates_fk FOREIGN KEY (tconst) REFERENCES titleBasics (tconst)
);
```

```{sql, connection="db"}
CREATE TABLE titleEpisodes (
	tconst VARCHAR(256),
    parentTconst VARCHAR(256),
    seasonRating INT,
    episodeNumber INT,
    CONSTRAINT episodesParentFK FOREIGN KEY (parentTconst) REFERENCES titleBasics (tconst)
);
```

```{sql, connection="db"}
CREATE TABLE titleCrew (
	tconst VARCHAR(256),
    crewID INT PRIMARY KEY AUTO_INCREMENT,
    CONSTRAINT crew_fk FOREIGN KEY (tconst) REFERENCES titleBasics (tconst)
);
```

```{sql, connection="db"}
CREATE TABLE titleWriters (
	tconst VARCHAR(256),
    crewID INT,
    writer VARCHAR(256),
    CONSTRAINT writerTitle_fk FOREIGN KEY (tconst) REFERENCES titleCrew (tconst),
	CONSTRAINT writerCrew_fk FOREIGN KEY (crewID) REFERENCES titleCrew (crewID)
);
```

```{sql, connection="db"}
CREATE TABLE titleDirectors (
	tconst VARCHAR(256),
    crewID INT,
    director VARCHAR(256),
    CONSTRAINT directorTitle_fk FOREIGN KEY (tconst) REFERENCES titleCrew (tconst),
	CONSTRAINT directorCrew_fk FOREIGN KEY (crewID) REFERENCES titleCrew (crewID)
);
```

```{sql, connection="db"}
CREATE TABLE titleAkas (
	titleId VARCHAR(256),
    ordering INT,
    title VARCHAR(256),
    language VARCHAR(256),
    types VARCHAR(256),
    attributes VARCHAR(256),
    isOriginalTitle BOOLEAN,
    CONSTRAINT akasTitle_fk FOREIGN KEY (titleId) REFERENCES titleBasics (tconst)
);
```

```{sql, connection="db"}
CREATE TABLE nameBasics (
    nconst VARCHAR(256) PRIMARY KEY,
    birthYear INT,
    deathYear INT,
    primaryName VARCHAR(256),
    age INT
);
```

```{sql, connection="db"}
CREATE TABLE nameTitles (
	nconst VARCHAR(256),
    knownForTitle VARCHAR(256),
    numTitleCount int,
    CONSTRAINT nameTitles_fk FOREIGN KEY (nconst) REFERENCES nameBasics (nconst)
);
```

```{sql, connection="db"}
CREATE TABLE nameProfession (
	nconst VARCHAR(256),
    primaryProfession VARCHAR(256),
    CONSTRAINT professionTitles_fk FOREIGN KEY (nconst) REFERENCES nameBasics (nconst)
);

```

```{sql, connection="db"}
CREATE TABLE titlePrincipals (
	tconst VARCHAR(256),
    ordering INT,
    nconst VARCHAR(256),
    category VARCHAR(256),
    job VARCHAR(256),
    CONSTRAINT principalsTitle_fk FOREIGN KEY (tconst) REFERENCES titleBasics (tconst),
    CONSTRAINT principalsName_fk FOREIGN KEY (nconst) REFERENCES nameBasics (nconst)
);
```

```{sql, connection="db"}
CREATE TABLE principalCharacters (
	tconst VARCHAR(256),
    nconst VARCHAR(256),
    charPlayed VARCHAR(256),
    CONSTRAINT charTitle_fk FOREIGN KEY (tconst) REFERENCES titlePrincipals (tconst),
    CONSTRAINT charName_fk FOREIGN KEY (nconst) REFERENCES titlePrincipals (nconst)
);
```

```{sql, connection="db"}
show tables;
```


## CREATE TABLE Commands

